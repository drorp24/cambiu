<script>

    function initialize() {
        location_settings();
        if (window.location.pathname != '/homepage') {
            // Now that google is defined, submit form to re-ajax search results & updateExchanges (= draw map, place markers & display restuls)
            // But only for  search page : homepage awaits user input and will submit only upon clicking the button (for performance)
            // Though getLocation() probably havent yet found the location, this if occurs only upon reload, so session holds the location
             console.log('not homepage: submitting form');
            $('#search_form').submit();
        } else {
            console.log('homepage. Not submitting form')
        }
    }

    function loadScript() {
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = 'https://maps.googleapis.com/maps/api/js?v=3.exp' +
        '&language=en&key=AIzaSyBjqKHd8skkCMWYd_uG7QMEmCGunJ2Q3Us&libraries=places&callback=initialize';
        document.body.appendChild(script);
    }

    window.onload = loadScript;

</script>