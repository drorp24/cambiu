<div id="landing_page">
	<div id="fluid" class="container-fluid photo_background">
		<div id="landing_background">
			<!--<video id="video_background" preload="auto" autoplay="autoplay" loop="loop" style="position: fixed; top: 0px; left: 0px; bottom: 0px; right: 0px; z-index: -100;"><source src="preview.mp4" type="video/mp4"></source>bgvideo</video>--> 				
		</div>
		<div id="landing_header">
			<div class="row">
	  			<div id="landing_name" class="text-center"></div>			
			</div>
		</div>
		<div id="landing_message">
			<div class="row">
				<div id="message" class="text-center">
					<div id="message_header"><%= t :title, scope: [@landing], default: 'Best currency exchange deals near you' %></div>
					<div class="col-md-6 col-md-offset-3" id="message_remainder">
						<%= t :text, scope: [@landing], default: 'Save on high commission fees with a few simple clicks. Anytime. Anywhere.' %>
					</div>
				</div>
			</div>
		</div>
		<div id="landing_form">
			<div class="row">
				<form id="new_user" method="post" action="/users" class="form-inline col-md-8 col-md-offset-2 col-xs-offset-1">
					<div id="mobile_input_trigger" class="form-group col-md-3 col-xs-10">
						<input class="form-control" placeholder="Check rates">
				  	</div>
					<div class="form-group col-md-3 col-xs-11">
						<input data-autonumeric="true" id="user_buy_amount" name="user[buy_amount]" class="form-control" placeholder="How much do you need">
				  	</div>
				  	<div class="form-group col-md-3 col-xs-11">
						<input type="text" name="user[buy_currency]" class="form-control" placeholder="In what currency">
				  	</div>
				  	<div id="the-basics" class="form-group col-md-3 col-xs-11">
						<input type="text" name="user[pay_currency]" class="form-control" placeholder="Paying with">
				  	</div>
				  	<div class="hidden" style="display:none">
				  		<input type="hidden" name="user[latitude]" value="51.507351">
				  		<input type="hidden" name="user[longitude]" value="-0.127758">
				  		<input type="hidden" name="user[bbox]" value="default">
				  		<input type="hidden" name="user[landing]" value="default">
				  		<input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
					</div>
				  	<div class="form-group col-md-3 col-xs-11">
						<button id="landing_main_button" class="form-control btn btn-success" type="submit">Get it</button>
					</div>
				</form>
			</div>
		</div>
		
		<div id="landing_footer">
		</div>
	</div>
</div>
<script>
$(document).ready(function() {
	
	getLocation();
	
	$('#mobile_input_trigger input').click(function() {
		$('#mobile_input_trigger').css('display', 'none');
		$('.form-group:not(#mobile_input_trigger)').css('display', 'block');
		$('#user_buy_amount').focus();
	})
	
	$('#landing_main_button').click(function() {
		ga('send', 'event', 'button', 'click', 'landing-main-button');
		mixpanel.track("Landing main button");
	})
	$('#join').click(function() {
		ga('send', 'event', 'button', 'click', 'join');
		mixpanel.track("Landing Join button");
	})


// typeahead - with override issues

	$('.typeahead.input-sm').siblings('input.tt-hint').addClass('hint-small');
	$('.typeahead.input-lg').siblings('input.tt-hint').addClass('hint-large');	
	
	var substringMatcher = function(strs) {
  		return function findMatches(q, cb) {
    	var matches, substrRegex;
 
	    // an array that will be populated with substring matches
	    matches = [];
	 
	    // regex used to determine if a string contains the substring `q`
	    substrRegex = new RegExp(q, 'i');
	 
	    // iterate through the pool of strings and for any string that
	    // contains the substring `q`, add it to the `matches` array
	    $.each(strs, function(i, str) {
	      if (substrRegex.test(str)) {
	        // the typeahead jQuery plugin expects suggestions to a
	        // JavaScript object, refer to typeahead docs for more info
	        matches.push({ value: str });
      }
    });
 
    cb(matches);
  };
};
 
var currencies = ['GBP', 'USD', 'EUR', 'AUD', 'CAD', 'JPY'];
 
$('#the-basics .typeahead').typeahead({
  hint: true,
  highlight: true,
  minLength: 1
},
{
  name: 'currencies',
  displayKey: 'value',
  source: substringMatcher(currencies)
});

})
</script>
